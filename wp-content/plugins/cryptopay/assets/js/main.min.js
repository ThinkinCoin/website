(async $=>{function handleUnloadEvent(){if(-1===navigator.userAgent.indexOf("MSIE")&&!document.documentMode)return!0;e.preventDefault()}function printError(errorMessage){var scrollElement;$(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(),$form.prepend('<div class="woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout">'+errorMessage+"</div>"),$form.removeClass("processing").unblock(),$form.find(".input-text, select, input:checkbox").trigger("validate").trigger("blur"),(scrollElement=(scrollElement=$(".woocommerce-NoticeGroup-updateOrderReview, .woocommerce-NoticeGroup-checkout")).length?scrollElement:$form).length&&$("html, body").animate({scrollTop:scrollElement.offset().top-100},1e3),$(document.body).trigger("checkout_error",[errorMessage])}function checkFormProcess(network){return window.cpHelpers.waitingPopup(CryptoPay.lang.checkingForm),new Promise(resolve=>{$.ajax({type:"POST",url:wc_checkout_params.checkout_url,data:$form.serialize(),dataType:"json",success:function(response){if($(window).off("beforeunload",handleUnloadEvent),response.success)$(".woocommerce-NoticeGroup-checkout").remove(),resolve(null);else if(!0===response.data.reload)window.location.reload();else{if(!0===response.data.refresh&&$(document.body).trigger("update_checkout"),response.message?printError(response.message):printError('<div class="woocommerce-error">'+CryptoPay.lang.defaultErrorMsg+"</div>"),"qr"===network.paymentType)return resolve({error:!0,message:CryptoPay.lang.qrCodePaymentMsg});resolve({error:!0})}},error:function(jqXHR,textStatus,errorThrown){$(window).off("beforeunload",handleUnloadEvent),printError('<div class="woocommerce-error">'+(errorThrown||CryptoPay.lang.defaultErrorMsg)+"</div>"),resolve({error:!0})}})})}await new Promise(resolve=>{if(0<CryptoPay.providers.length){let providers=CryptoPay.providers;CryptoPay.providers={},providers.forEach(function(provider,index){let key=provider.toLowerCase();key=key.replace("evmchains","evmBased"),CryptoPay.providers[key]=window[provider],index===providers.length-1&&resolve(CryptoPay.providers)})}else resolve(CryptoPay.providers={})}),CryptoPay.startPayment=(order,params)=>{if(!order.amount)throw new Error("Order amount is required");if(order.currency)return window.CryptoPayApp=initCryptoPay("cryptopay",Object.assign(CryptoPay,{order:order,params:params}));throw new Error("Order currency is required")},CryptoPay.autoLoad&&(window.CryptoPayApp=initCryptoPay("cryptopay",CryptoPay)),CryptoPay.checkoutPage&&($form=$("form.checkout"),CryptoPay.hooks.beforeThanPayNow=network=>checkFormProcess(network),CryptoPay.hooks.beforeThanQrPaymentConfirmation=network=>checkFormProcess(network),$(document).on("updated_checkout",function(){var selectedNetwork;window.CryptoPayApp&&(window.CryptoPayApp.store&&(selectedNetwork=window.CryptoPayApp.store.getters.getSelectedNetwork)&&"qr"===selectedNetwork.paymentType&&window.qrVerifierInterval&&clearInterval(window.qrVerifierInterval),window.CryptoPayApp.reset()),window.CryptoPayApp=initCryptoPay("cryptopay",CryptoPay)}),$("form.checkout").on("change",'input[name="payment_method"]',function(){$(document.body).trigger("update_checkout")}))})(jQuery);
//# sourceMappingURL=main.min.js.map
